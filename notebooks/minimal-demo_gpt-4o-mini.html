

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Example: Run ACS benchmark task &mdash; folktexts 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../_static/custom.js?v=882eb7ae"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            folktexts
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Readme file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/modules.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Example notebooks</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">folktexts</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Example: Run ACS benchmark task</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/minimal-demo_gpt-4o-mini.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Example:-Run-ACS-benchmark-task">
<h1>Example: Run ACS benchmark task<a class="headerlink" href="#Example:-Run-ACS-benchmark-task" title="Link to this heading"></a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">folktexts</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">folktexts</span><span class="o">.</span><span class="n">__version__</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
folktexts.__version__=&#39;0.1.0&#39;
</pre></div></div>
</div>
<p>Load environment variables (e.g., API keys):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dotenv</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="n">load_dotenv</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True
</pre></div></div>
</div>
<p>Directory where data is saved or will be saved to (<strong>change as appropriate</strong>):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ROOT_DIR</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;~/&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">ROOT_DIR</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>
<span class="n">RESULTS_ROOT_DIR</span> <span class="o">=</span> <span class="n">ROOT_DIR</span> <span class="o">/</span> <span class="s2">&quot;folktexts-results&quot;</span>
<span class="n">RESULTS_ROOT_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Set LLM and task name:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MODEL_NAME</span> <span class="o">=</span> <span class="s2">&quot;openai/gpt-4o-mini&quot;</span>
<span class="n">TASK_NAME</span> <span class="o">=</span> <span class="s2">&quot;ACSIncome&quot;</span>     <span class="c1"># ACSIncome -&gt; income prediction</span>
</pre></div>
</div>
</div>
<section id="Construct-LLM-Classifier">
<h2>Construct LLM Classifier<a class="headerlink" href="#Construct-LLM-Classifier" title="Link to this heading"></a></h2>
<p>Load task (maps tabular data to text prompts), and configure the <code class="docutils literal notranslate"><span class="pre">LLMClassifier</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">USE_NUMERIC_QA</span> <span class="o">=</span> <span class="kc">True</span>         <span class="c1"># Use numeric Q&amp;A prompts</span>
<span class="c1"># USE_NUMERIC_QA = False        # Use multiple-choice Q&amp;A prompts</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">folktexts.acs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACSTaskMetadata</span>
<span class="n">task</span> <span class="o">=</span> <span class="n">ACSTaskMetadata</span><span class="o">.</span><span class="n">get_task</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">TASK_NAME</span><span class="p">,</span>
    <span class="n">use_numeric_qa</span><span class="o">=</span><span class="n">USE_NUMERIC_QA</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">folktexts.classifier</span><span class="w"> </span><span class="kn">import</span> <span class="n">WebAPILLMClassifier</span>

<span class="n">llm_clf</span> <span class="o">=</span> <span class="n">WebAPILLMClassifier</span><span class="p">(</span>
    <span class="n">model_name</span><span class="o">=</span><span class="n">MODEL_NAME</span><span class="p">,</span>
    <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Load-Dataset">
<h2>Load Dataset<a class="headerlink" href="#Load-Dataset" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">folktexts.acs</span><span class="w"> </span><span class="kn">import</span> <span class="n">ACSDataset</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">ACSDataset</span><span class="o">.</span><span class="n">make_from_task</span><span class="p">(</span>
    <span class="n">task</span><span class="o">=</span><span class="n">task</span><span class="p">,</span>
    <span class="n">survey_year</span><span class="o">=</span><span class="s2">&quot;2018&quot;</span><span class="p">,</span>
    <span class="n">subsampling</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span>
    <span class="n">cache_dir</span><span class="o">=</span><span class="n">DATA_DIR</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">subsampling</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Loading ACS data...
dataset.subsampling=0.002
CPU times: user 43.5 s, sys: 10.3 s, total: 53.8 s
Wall time: 54 s
</pre></div></div>
</div>
</section>
<section id="Example-tabular-row,-prompt,-and-LLM-prediction">
<h2>Example tabular row, prompt, and LLM prediction<a class="headerlink" href="#Example-tabular-row,-prompt,-and-LLM-prediction" title="Link to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_example</span><span class="p">,</span> <span class="n">y_example</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">sample_n_train_examples</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">X_example</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AGEP</th>
      <th>COW</th>
      <th>SCHL</th>
      <th>MAR</th>
      <th>OCCP</th>
      <th>POBP</th>
      <th>RELP</th>
      <th>WKHP</th>
      <th>SEX</th>
      <th>RAC1P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2215517</th>
      <td>75</td>
      <td>1.0</td>
      <td>19.0</td>
      <td>2</td>
      <td>4020.0</td>
      <td>54</td>
      <td>0</td>
      <td>20.0</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt_example</span> <span class="o">=</span> <span class="n">llm_clf</span><span class="o">.</span><span class="n">encode_row</span><span class="p">(</span><span class="n">X_example</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">question</span><span class="o">=</span><span class="n">llm_clf</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">question</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prompt_example</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The following data corresponds to a survey respondent. The survey was conducted among US residents in 2018. Please answer the question based on the information provided. The data provided is enough to reach an approximate answer.

Information:
- The age is: 75 years old.
- The class of worker is: Working for a for-profit private company or organization.
- The highest educational attainment is: Some college, 1 or more years, no degree.
- The marital status is: Widowed.
- The occupation is: Cooks.
- The place of birth is: West Virginia.
- The relationship to the reference person in the survey is: The reference person itself.
- The usual number of hours worked per week is: 20 hours.
- The sex is: Female.
- The race is: White.

Question: What is the probability that this person&#39;s estimated yearly income is above $50,000 ?
Answer (between 0 and 1): 0.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_score</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">llm_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_example</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred_score</span> <span class="o">&gt;=</span> <span class="n">llm_clf</span><span class="o">.</span><span class="n">threshold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;score=</span><span class="si">{</span><span class="n">y_pred_score</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">; pred=</span><span class="si">{</span><span class="n">y_pred</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">; label=</span><span class="si">{</span><span class="n">y_example</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3bc1a01b3c9b4d9dbfdda5cef0d01530", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
score=0.05; pred=0; label=0
</pre></div></div>
</div>
</section>
<section id="Run-Benchmark">
<h2>Run Benchmark<a class="headerlink" href="#Run-Benchmark" title="Link to this heading"></a></h2>
<p><strong>Note:</strong> Helper constructors exist at <code class="docutils literal notranslate"><span class="pre">Benchmark.make_acs_benchmark</span></code> and <code class="docutils literal notranslate"><span class="pre">Benchmark.make_benchmark</span></code> that avoid the above boilerplate code.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">folktexts.benchmark</span><span class="w"> </span><span class="kn">import</span> <span class="n">Benchmark</span>
<span class="n">bench</span> <span class="o">=</span> <span class="n">Benchmark</span><span class="p">(</span><span class="n">llm_clf</span><span class="o">=</span><span class="n">llm_clf</span><span class="p">,</span> <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">bench</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">results_root_dir</span><span class="o">=</span><span class="n">RESULTS_ROOT_DIR</span> <span class="o">/</span> <span class="s2">&quot;gpt-4o-mini&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "a9361b60efea4173bdba9adc44bd37d4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:root:Skipping group 3 with 5 samples
WARNING:root:Skipping group 5 with 1 samples
WARNING:root:Skipping group 7 with 1 samples
WARNING:root:Skipping group 8 with 11 samples
WARNING:root:Skipping group 9 with 8 samples
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 6.55 s, sys: 3.78 s, total: 10.3 s
Wall time: 4min 41s
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bench</span><span class="o">.</span><span class="n">plot_results</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_minimal-demo_gpt-4o-mini_21_0.png" src="../_images/notebooks_minimal-demo_gpt-4o-mini_21_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_minimal-demo_gpt-4o-mini_21_1.png" src="../_images/notebooks_minimal-demo_gpt-4o-mini_21_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_minimal-demo_gpt-4o-mini_21_2.png" src="../_images/notebooks_minimal-demo_gpt-4o-mini_21_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_minimal-demo_gpt-4o-mini_21_3.png" src="../_images/notebooks_minimal-demo_gpt-4o-mini_21_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_minimal-demo_gpt-4o-mini_21_4.png" src="../_images/notebooks_minimal-demo_gpt-4o-mini_21_4.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_minimal-demo_gpt-4o-mini_21_5.png" src="../_images/notebooks_minimal-demo_gpt-4o-mini_21_5.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">bench</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calibration, ECE: </span><span class="si">{</span><span class="n">bench</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;ece&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fairness, equalized odds: </span><span class="si">{</span><span class="n">bench</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;equalized_odds_diff&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">bench</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Accuracy: 0.799
Calibration, ECE: 0.054
Fairness, equalized odds: 0.278
{ &#39;accuracy&#39;: 0.7987987987987988,
  &#39;accuracy_diff&#39;: 0.15210084033613447,
  &#39;accuracy_ratio&#39;: 0.8361990950226245,
  &#39;balanced_accuracy&#39;: 0.7819052854786774,
  &#39;balanced_accuracy_diff&#39;: 0.17337164750957856,
  &#39;balanced_accuracy_ratio&#39;: 0.8108672936259144,
  &#39;benchmark_hash&#39;: 2067127462,
  &#39;brier_score_loss&#39;: 0.15524125268127326,
  &#39;config&#39;: {...},
  &#39;current_time&#39;: &#39;2025.04.08-18.02.48&#39;,
  &#39;ece&#39;: 0.053879603603603624,
  &#39;ece_quantile&#39;: 0.0640231471471472,
  &#39;equalized_odds_diff&#39;: 0.2777777777777778,
  &#39;equalized_odds_ratio&#39;: 0.0,
  &#39;fnr&#39;: 0.2773109243697479,
  &#39;fnr_diff&#39;: 0.2777777777777778,
  &#39;fnr_ratio&#39;: 0.375,
  &#39;fpr&#39;: 0.1588785046728972,
  &#39;fpr_diff&#39;: 0.19745222929936307,
  &#39;fpr_ratio&#39;: 0.0,
  &#39;log_loss&#39;: 0.5828355173643137,
  &#39;model_name&#39;: &#39;openai/gpt-4o-mini&#39;,
  &#39;n_negatives&#39;: 214,
  &#39;n_positives&#39;: 119,
  &#39;n_samples&#39;: 333,
  &#39;plots&#39;: {...},
  &#39;ppr&#39;: 0.36036036036036034,
  &#39;ppr_diff&#39;: 0.21971104231166153,
  &#39;ppr_ratio&#39;: 0.4560551865099642,
  &#39;precision&#39;: 0.7166666666666667,
  &#39;precision_diff&#39;: 0.30097087378640774,
  &#39;precision_ratio&#39;: 0.6990291262135923,
  &#39;predictions_path&#39;: &#39;/Users/acruz/folktexts-results/gpt-4o-mini/openai/gpt-4o-mini_bench-2067127462/ACSIncome_subsampled-0.002_seed-42_hash-2198313341.test_predictions.csv&#39;,
  &#39;results_dir&#39;: &#39;/Users/acruz/folktexts-results/gpt-4o-mini/openai/gpt-4o-mini_bench-2067127462&#39;,
  &#39;results_root_dir&#39;: &#39;/Users/acruz/folktexts-results/gpt-4o-mini&#39;,
  &#39;roc_auc&#39;: 0.8308136338647608,
  &#39;threshold&#39;: 0.5,
  &#39;tnr&#39;: 0.8411214953271028,
  &#39;tnr_diff&#39;: 0.197452229299363,
  &#39;tnr_ratio&#39;: 0.802547770700637,
  &#39;tpr&#39;: 0.7226890756302521,
  &#39;tpr_diff&#39;: 0.2777777777777778,
  &#39;tpr_ratio&#39;: 0.6666666666666666}
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Social Foundations of Computation, at MPI-IS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>